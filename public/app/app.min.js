!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=9)}([function(module,exports,__webpack_require__){function ringBell(){new Audio("audio/alarm_edit.mp3").play(),this.stop(),togglePlayButton(this.container)}function startTimerHelper(state){state.timer.start(1e3*state.settings.work,function(){ringBell.call(this),state.currentSession.end=new Date,$("#feedback-modal").modal("show")}),state.currentSession.start=new Date,togglePlayButton(state.timer.container)}const togglePlayButton=__webpack_require__(3);module.exports={countdownListener:function(container,state){container.addEventListener("click",event=>{event.preventDefault(),container.querySelector(".glyphicon-play")?(state.settings.work=60*document.getElementById("countdown-work").value,state.settings.break=60*document.getElementById("countdown-break").value,startTimerHelper(state)):container.querySelector(".glyphicon-stop")&&(state.timer.stop(),togglePlayButton(container))})},ringBell:ringBell,startTimerHelper:startTimerHelper}},function(module,exports,__webpack_require__){function timelineHelper(state,container){google.charts.load("current",{packages:["timeline"]});const data=populateTable(state);google.charts.setOnLoadCallback(function(){drawTimeline(data,container)}),data.length?document.getElementById("empty-timeline").classList.add("hide"):document.getElementById("empty-timeline").classList.remove("hide")}const{drawTimeline:drawTimeline,populateTable:populateTable}=__webpack_require__(10);module.exports={timelineListener:function(timeline,state){timeline.addEventListener("click",event=>{event.preventDefault(),setTimeout(function(){timelineHelper(state,document.getElementById("timeline-container"))},10)}),window.onresize=function(){timelineHelper(state,document.getElementById("timeline-container"))}},timelineHelper:timelineHelper}},function(module,exports){module.exports={pageDisplay:function(page){["timer-page","settings-page","timeline-page"].forEach(element=>{document.getElementById(element).classList.add("hide")}),document.getElementById(page).classList.remove("hide")},controlDisplay:function(control){["timer-button","settings-button","timeline-button"].forEach(element=>{document.getElementById(element).classList.remove("hide")}),control.classList.add("hide")}}},function(module,exports){module.exports=function(wrapperElement){let playButton=wrapperElement.querySelector(".glyphicon");playButton.classList.toggle("glyphicon-play"),playButton.classList.toggle("glyphicon-stop")}},function(module,exports,__webpack_require__){const togglePlayButton=__webpack_require__(3),ringBell=__webpack_require__(0).ringBell,startTimerHelper=__webpack_require__(0).startTimerHelper,timelineHelper=__webpack_require__(1).timelineHelper;module.exports={modalListener:function(form,state){const note=document.getElementById("modal-note");form.addEventListener("click",event=>{event.target.classList.contains("mood-feedback")&&(state.currentSession.mood=event.target.getAttribute("data-mood"),note.classList.remove("hidden"))}),form.addEventListener("submit",event=>{event.preventDefault();const currentSession=Object.assign({},state.currentSession);state.history.push(currentSession),$.ajax("../me",{method:"PUT",data:{username:state.username,id:state.cookie.val,history:state.history}}).then(()=>{$("#feedback-modal").modal("hide"),timelineHelper(state,document.getElementById("timeline-container"))})}),$("#feedback-modal").on("hidden.bs.modal",event=>{event.preventDefault();const wrapperElement=document.getElementById("timer-module");note.classList.add("hidden"),togglePlayButton(wrapperElement),state.timer.start(1e3*state.settings.break,function(){ringBell.call(this),$("#resume-modal").modal("show")})})},resumeModalListener:function(modal,state){modal.querySelector(".modal-button").addEventListener("click",event=>{document.getElementById("timer-module"),$("#resume-modal").modal("hide"),startTimerHelper(state)})}}},function(module,exports,__webpack_require__){const{pageDisplay:pageDisplay,controlDisplay:controlDisplay}=__webpack_require__(2);module.exports=function(navGroup,state){navGroup.addEventListener("click",event=>{event.target.dataset.page&&(pageDisplay(event.target.dataset.page),controlDisplay(event.target))})}},function(module,exports){module.exports=function(settings,state){settings.addEventListener("click",event=>{event.target.textContent="Saving...",event.target.setAttribute("disabled","disabled"),state.settings.work=document.getElementById("default-work").value,state.settings.break=document.getElementById("default-break").value,document.getElementById("countdown-work").setAttribute("value",state.settings.work),document.getElementById("countdown-break").setAttribute("value",state.settings.break),$.ajax({method:"PUT",url:"../me",data:{id:state.cookie.val,username:state.username,settings:{work:state.settings.work,break:state.settings.break}}}).then(data=>event.target.textContent="Saved")})}},function(module,exports){module.exports=function(cookieString,state){"string"==typeof cookieString&&cookieString.length>0&&cookieString.split(";").forEach(pair=>{let items=pair.split("=");"pomodoro"===items[0]&&(state.cookie={name:items[0],val:items[1]})})}},function(module,exports){class Timer{constructor(container,settings){let mql=window.matchMedia("(max-width: 768px)");mql.matches&&window.innerHeight<window.innerWidth&&container.classList.add("landscape-timer-wrapper"),container.setAttribute("style",`height: ${container.offsetWidth}px`),window.addEventListener("resize",event=>{mql.matches?window.innerHeight<window.innerWidth?container.classList.add("landscape-timer-wrapper"):container.classList.remove("landscape-timer-wrapper"):window.innerHeight<window.innerWidth&&container.classList.remove("landscape-timer-wrapper"),container.offsetWidth>0&&container.setAttribute("style",`height: ${container.offsetWidth}px`)}),this.container=container,container.innerHTML=`<div class="spinner-left timer"></div>\n        <div class="spinner-right timer"></div>\n        <div class="hide-left timer"></div>\n        <div class="hide-right timer"></div>\n        <div class="timer timer-button">\n          <button class="glyphicon glyphicon-play" type="button"></button>\n        </div>\n      `,this.container.querySelector(".glyphicon").onfocus=function(){this.blur()},this.settings=settings||{duration:1e3,interval:100},this.counter={count:0,epoch:null},this.callback=null,this.anim={}}start(duration,callback){this.settings.duration=duration||this.settings.duration,this.counter.count=0,this.callback=callback,this.timeoutId=setTimeout(()=>{this.anim.spinnerLeft.cancel(),this.anim.spinnerRight.cancel(),this.anim.rightOpa.cancel(),this.callback.call(this)},duration),this.draw()}stop(){clearTimeout(this.timeoutId),this.anim.spinnerLeft.pause();for(let animation in this.anim)this.anim[animation].pause()}draw(){this.anim.spinnerLeft=this.container.querySelector(".spinner-left").animate([{transform:"rotate(0)"},{transform:"rotate(180deg)"}],{duration:this.settings.duration/2,endDelay:this.settings.duration/2,fill:"forwards"}),this.anim.spinnerRight=this.container.querySelector(".spinner-right").animate([{transform:"rotate(0deg)"},{transform:"rotate(180deg)"}],{duration:this.settings.duration/2,delay:this.settings.duration/2}),this.anim.rightOpa=this.container.querySelector(".spinner-right").animate([{opacity:0},{opacity:1,offset:.5},{opacity:1}],{duration:this.settings.duration,easing:"steps(2)"})}}module.exports=function(container,settings){return new Timer(container,settings)}},function(module,exports,__webpack_require__){const{countdownListener:countdownListener,ringBell:ringBell}=__webpack_require__(0),timer=__webpack_require__(8),{modalListener:modalListener,resumeModalListener:resumeModalListener}=__webpack_require__(4),parseCookieString=__webpack_require__(7),{pageDisplay:pageDisplay}=__webpack_require__(2),navListener=__webpack_require__(5),settingsListener=__webpack_require__(6),{timelineListener:timelineListener,timelineHelper:timelineHelper}=__webpack_require__(1);let state={username:null,settings:{work:25,break:5},cookie:{name:null,val:null},history:[],currentSession:{start:null,end:null,mood:null},timer:timer(document.getElementById("timer-module"),{duration:1e3,interval:100})};const cookies=document.cookie;state.username=window.location.search.slice(1),parseCookieString(cookies,state),$.ajax({method:"GET",url:`../me`,data:{username:state.username,id:state.cookie.val}}).then(data=>{state.settings=data.settings,state.history=data.history,document.getElementById("account-interface").querySelectorAll("a").forEach(anchor=>{"Login/Demo"===anchor.textContent||"Signup"===anchor.textContent?anchor.classList.add("hide"):anchor.classList.toggle("hide")}),document.getElementById("countdown-work").setAttribute("value",state.settings.work),document.getElementById("countdown-break").setAttribute("value",state.settings.break)}),navListener(document.getElementById("nav-controls"),state),countdownListener(document.getElementById("timer-module"),state),modalListener(document.getElementById("modal-submit"),state),resumeModalListener(document.getElementById("resume-modal"),state),settingsListener(document.getElementById("settings-save-button"),state),timelineListener(document.getElementById("timeline-button"),state),document.getElementById("timer-button").addEventListener("click",event=>{setTimeout(function(){const container=document.getElementById("timer-module");container.setAttribute("style",`height: ${container.offsetWidth}px`)},10)})},function(module,exports){module.exports={drawTimeline:function(dates,container){if(dates.length){google.charts.load("current",{packages:["timeline"]});const chart=new google.visualization.Timeline(container),table=new google.visualization.DataTable;table.addColumn({type:"string",id:"Day"}),table.addColumn({type:"string",id:"Mood"}),table.addColumn({type:"date",id:"Start"}),table.addColumn({type:"date",id:"End"}),table.addRows(dates),chart.draw(table,{width:container.parentNode.offsetWidth,height:container.parentNode.offsetHeight,hAxis:{viewWindow:{min:new Date(0,0,0,0,0,0),max:new Date(0,0,0,23,59,59)},format:"h:mm aa"}})}},populateTable:function(state){let recentDates=[];const now=new Date;now.setDate(now.getDate()-now.getDay()),now.setHours(0,0,0);const beginMs=now.valueOf();now.setDate(now.getDate()+6),now.setHours(23,59,59);const endMs=now.valueOf();return state.history.forEach(session=>{let start=new Date(session.start),end=new Date(session.end);start.valueOf()>beginMs&&end.valueOf()<endMs&&recentDates.push([{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}[start.getDay()],session.mood,new Date(0,0,0,start.getHours(),start.getMinutes(),start.getSeconds()),new Date(0,0,0,end.getHours(),end.getMinutes(),end.getSeconds())])}),recentDates}}}]);